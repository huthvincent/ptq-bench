# ==============================================================================
# Track C: KV Cache 量化赛道
# 量化 Key/Value Cache 以降低长上下文推理的显存占用
# 适用于 KIVI、KVQuant 等方法
# ==============================================================================

name: "C"
display_name: "Track C: KV Cache Quantization"
description: "量化 KV Cache 以节省长上下文推理的显存。覆盖 KIVI、KVQuant 等方法。"

constraints:
  weight_bits: 16                  # 权重不量化
  activation_bits: 16              # 激活不量化
  kv_quantize: true                # 量化 KV Cache
  kv_bits_default: 4               # KV 默认量化位数

eval:
  ppl_datasets: ["wikitext2", "longbench"]
  lm_eval_tasks:
    - "mmlu"
    - "hellaswag"
    - "winogrande"
  primary_metric: "avg_accuracy"
  system_metrics: false
  # Phase 2: 长上下文评测
  long_context:
    enabled: true                  # Phase 2 已启用
    max_seq_len: 4096
    tasks: ["longbench"]
  # Phase 3: KV Cache 压力测试 (极端设置)
  kv_stress_test:
    enabled: true
    passkey_retrieval:
      enabled: true
      num_keys: 20                 # 测试 20 个随机密钥
      context_length: 16384        # 极端: 16K 上下文
      depths: [0.1, 0.25, 0.5, 0.75]
      seed: 42
    generation_ppl:
      enabled: true
      num_prompts: 5               # 5 个 PG19 长文本 prompt
      prompt_length: 4096          # 极端: 4K prompt
      gen_length: 2048             # 极端: 生成 2K tokens
