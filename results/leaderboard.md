# PTQ Benchmark Leaderboard

---

## Track A: Weight-Only Quantization (W4A16)

> **æ¨¡å‹**: Qwen2.5-7B | **ç¡¬ä»¶**: H200 NVL 141GB

| æ’å | æ–¹æ³• | PPL (WikiText-2) â†“ | Avg Accuracy â†‘ | PPL é€€åŒ– | Acc é€€åŒ– | VRAM (MB) | é‡åŒ–è€—æ—¶ |
|:----:|------|:-------------------:|:--------------:|:--------:|:--------:|:---------:|:--------:|
| ğŸ¥‡ | **FP16** (baseline) | **6.16** | **0.7351** | â€” | â€” | 18,367 | â€” |
| ğŸ¥ˆ | **AWQ** (W4, pre-quantized) | **6.91** | **0.7233** | +0.75 | -1.18% | 19,891 | 5.6s |
| ğŸ¥‰ | **RTN** (W4, per-group sym) | **7.27** | **0.7098** | +1.11 | -2.53% | 21,822 | 0.1s |
| â›” | **GPTQ** (blocked) | â€” | â€” | â€” | â€” | â€” | â€” |

> **æ³¨**: AWQ ä½¿ç”¨ `Qwen/Qwen2.5-7B-Instruct-AWQ` é¢„é‡åŒ–æ¨¡å‹ã€‚GPTQ å› åº“å…¼å®¹æ€§é˜»å¡ã€‚

---

## Track C: KV Cache Compression â€” æç«¯å‹åŠ›æµ‹è¯• (Bug ä¿®å¤å)

> **ç¡¬ä»¶**: H200 NVL 141GB | **æ—¥æœŸ**: 2026-02-17
>
> âš ï¸ **é‡å¤§ä¿®å¤**: ä¹‹å‰çš„ Track C ç»“æœå› é‡åŒ–ä»£ç æœªåœ¨ generate() ä¸­æ‰§è¡Œè€Œå…¨éƒ¨æ— æ•ˆ (ä¸ FP16 å®Œå…¨ä¸€è‡´)ã€‚
> è¯¦è§ä¸‹æ–¹ **Bug ä¿®å¤è¯´æ˜**ã€‚ä»¥ä¸‹ä¸ºä¿®å¤åçš„æ­£ç¡®ç»“æœã€‚

### Qwen2.5-7B â€” Passkey Retrieval (16K context, 10 keys Ã— 4 depths)

| æ–¹æ³• | æ·±åº¦ 10% | æ·±åº¦ 25% | æ·±åº¦ 50% | æ·±åº¦ 75% | **æ€»ä½“** |
|------|:--------:|:--------:|:--------:|:--------:|:--------:|
| **FP16** | 10/10 âœ… | 10/10 âœ… | 10/10 âœ… | 10/10 âœ… | **100%** |
| **KIVI** (INT2, res=4) | 0/10 âŒ | 0/10 âŒ | 0/10 âŒ | 0/10 âŒ | **0%** |
| **KVQuant** (INT2+outlier, res=4) | 1/10 | 3/10 | 0/10 | 0/10 | **10%** |
| **FORGE** (SVD, chunk=64, e=0.95) | 0/10 âŒ | 0/10 âŒ | 0/10 âŒ | 0/10 âŒ | **0%** |

### Generation PPL (prompt=4K, gen=2K, teacher-forcing on generated text)

| æ–¹æ³• | æ ·æœ¬ 0 | æ ·æœ¬ 1 | æ ·æœ¬ 2 | **Avg** |
|------|:------:|:------:|:------:|:-------:|
| **FP16** | 1.11 | 1.21 | 1.07 | **1.13** |
| **KIVI** (INT2, res=4) | 1.04 | 1.03 | 1.16 | **1.08** |
| **KVQuant** (INT2+outlier, res=4) | 1.07 | 1.11 | 1.11 | **1.10** |

> **æ³¨**: Generation PPL ~1.0 æ˜¯å› ä¸º greedy decoding ç”Ÿæˆçš„ token åºåˆ—åœ¨ teacher-forcing ä¸‹å…·æœ‰é«˜è‡ªæ´½æ€§ã€‚è¯¥æŒ‡æ ‡æ— æ³•æœ‰æ•ˆåŒºåˆ†æ–¹æ³•å·®å¼‚ã€‚**Passkey Retrieval æ˜¯æ›´æœ‰æ•ˆçš„ discriminatorã€‚**

---

## Track C åˆ†æ

### Bug ä¿®å¤è¯´æ˜

Transformers v5.x çš„ `Attention.forward()` åªè¿”å› `(attn_output, attn_weights)` ä¸¤ä¸ªå€¼ã€‚KV Cache é€šè¿‡ `DynamicCache.layers[i].update()` **å°±åœ°æ›´æ–°**ã€‚

ä¸‰ä¸ªæ–¹æ³• (FORGE/KIVI/KVQuant) çš„æ—§ä»£ç ä¾èµ– `outputs[2]` è·å– KV States:
```python
# æ—§ä»£ç  (æ°¸è¿œä¸ä¼šæ‰§è¡Œ)
if isinstance(outputs, tuple) and len(outputs) >= 3:  # v5.x ä¸‹æ°¸è¿œ False
    past_kv = outputs[2]
    # ... é‡åŒ–é€»è¾‘ ...
```

**ä¿®å¤**: å­ç±»åŒ– `DynamicLayer`ï¼Œè¦†å†™ `update()` æ–¹æ³•æ‹¦æˆª KV States å¹¶é‡åŒ–ã€‚

### æ ¸å¿ƒç»“è®º

| å‘ç° | è¯¦æƒ… |
|------|------|
| KIVI (INT2, res=4) | 16K Passkey ä» **100% â†’ 0%**ï¼Œå…¨æ·±åº¦å´©æºƒ |
| KVQuant (INT2+outlier, res=4) | 16K Passkey **10%**ï¼Œoutlier éš”ç¦»ç•¥æœ‰å¸®åŠ© |
| FORGE (SVD, e=0.95, chunk=64) | 16K Passkey **0%**ï¼ŒSVD å‹ç¼©ä¹Ÿä¼šä¸¢å¤±å…³é”®ä¿¡æ¯ |
| Gen PPL | Greedy decoding è‡ªæ´½æ€§é«˜ (PPL~1.0)ï¼Œæ— æ³•åŒºåˆ†æ–¹æ³• |

### æ–¹æ³•ç†è®ºå¯¹æ¯” (ä¿®å¤å)

| æ–¹æ³• | å‹ç¼©æ–¹å¼ | Passkey 16K | å®šæ€§è¯„ä»· |
|------|----------|:-----------:|:--------:|
| FP16 | æ— å‹ç¼© | **100%** | baseline |
| KIVI | INT2 per-ch/per-tok (res=4) | **0%** | æç«¯é€€åŒ– |
| KVQuant | INT2 + outlier éš”ç¦» (res=4) | **10%** | ä¸¥é‡é€€åŒ–ï¼Œoutlier ç•¥æœ‰å¸®åŠ© |
| FORGE | SVD åŠ¨æ€ç§© (e=0.95) | **0%** | æç«¯é€€åŒ– |

---

## ç¯å¢ƒä¿¡æ¯

| é¡¹ç›® | ç‰ˆæœ¬ |
|------|------|
| GPU | NVIDIA H200 NVL 141GB |
| PyTorch | 2.10.0+cu128 |
| Transformers | 5.1.0 |
| lm-eval | 0.4.11 |
| Python | 3.13 |
